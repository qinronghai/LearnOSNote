##  什么是进程通信

顾名思义，进程通信就是指进程之间的信息交换。
进程是分配系统资源的单位（包括内存地址空间），因此各进程拥有的内存地址空间相互独立。

![image.png](https://pic.rmb.bdstatic.com/bjh/59f79bce0bae0aef84dc8c9199c608b5.jpeg)

为了保证安全，一个进程不能直接访问另一个进程的地址空间。

但是进程之间的信息交换又是必须实现的。为了保证进程间的安全通信，操作系统提供了一些方法。

##  共享空间

为两个进程分配一个共享空间

![image.png](https://pic.rmb.bdstatic.com/bjh/37735ab92ce08351cf7c4384485788a2.jpeg)

注意：两个进程对共享空间的访问必须是互斥的（互斥访问通过操作系统提供的工具实现）。

共享存储分为两种：

1. 基于数据结构的共享

	基于数据结构的共享：比如共享空间里只能放一个长度为10的数组。这种共享方式速度慢、限制多，是一种低级通信方式

2. 基于存储区的共享

	基于存储区的共享：在内存中画出一块共享存储区，数据的形式、存放位置都由进程控制，而不是操作系统。相比之下，这种共享方式速度更快，是一种高级通信方式。

##  管道通信

“管道”是指用于连接读写进程的一个共享文件，又名pipe文件。其实就是在内存中开辟一个大小固定的缓冲区

![image.png](https://pic.rmb.bdstatic.com/bjh/c0ac46018cd4385975600c3ea4ae2229.jpeg)

1. 管道只能采用半双工通信，某一时间段内只能实现单向的传输。如果要实现双向同时通信，则需要设置
两个管道。
2. 各进程要互斥地访问管道。
3. 数据以字符流的形式写入管道，当管道写满时，写进程的wite(0系统调用将被阻塞，等待读进程将数据取走。当读进程将数据全部取走后，管道变空，此时读进程的read0系统调用将被阻塞。
4. 如果没写满，就不允许读。如果没读空，就不允许写。
5. 数据一旦被读出，就从管道中被抛弃，这就意味着读进程最多只能有一个，否则可能会有读错数据的情况。

##  消息传递

进程间的数据交换以格式化的消息(Message)为单位。进程通过操作系统提供的“发送消息/接收消息”两个原语进行数据交换。

![image.png](https://pic.rmb.bdstatic.com/bjh/ea4283287dca6ca685bd930e03b7acad.jpeg)

消息头包括：发送进程D、接受进程D、消息类型、消息长度等格式化的信息（计算机网络中发送的“报文”其实就是一种格式化的消息。

消息传递的两种方式:

1. 直接通信方式

	消息直接挂到接收进程的**消息缓冲队列**上

	![image.png](https://pic.rmb.bdstatic.com/bjh/6e994e65311ff2d425118ecf1d55555f.jpeg)

2. 间接通信方式

	消息要先发送到中间实体（信箱）中，因此也称“信箱通信方式”。Eg:计网中的电子邮件系统

	![image.png](https://pic.rmb.bdstatic.com/bjh/4e6542df15caeefdb6784a0239007657.jpeg)

